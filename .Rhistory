pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros.
Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix,
dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
mutate(contains("effect"), ~paste(.,"%"))%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros.
Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix,
dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
mutate_at(contains("effect"), ~paste(.,"%"))%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros.
Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix,
dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
mutate(across(contains("effect")), ~paste(.,"%"))%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros.
Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix,
dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros.
Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix,
dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros. Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix, dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros. Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix, dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)%>%
save_kable("Outputs/table_simulation_result.png")
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
column_spec (3:5,border_left = T, border_right = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
column_spec (3:5,border_left = T, border_right = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
column_spec (c(1,7),border_left = F, border_right = T)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros. Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix, dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)%>%
save_kable("Outputs/table_simulation_result.png")
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
column_spec (c(1,7),border_left = F, border_right = T)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros. Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix, dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
column_spec (c(1,7),border_left = F, border_right = T)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros. Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix, dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)%>%
save_kable("Outputs/table_simulation_result.png")
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
column_spec (c(1,7),border_left = F, border_right = T)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros. Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix, dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)%>%
save_kable("Outputs/table_simulation_result.png")
bind_rows(
df_boycott_effect1,
df_boycott_effect2
)%>%
# mutate(
#   across(contains("effect")), ~paste(.,"%")
#   )%>%
rename(
Label = label,
`Prix initial` = rounded_initial_price,
`Prix sans activiste` = rounded_absence_price,
`Prix avec le boycott`= rounded_boycott_price,
`Effet total du boycott sur le prix` = total_effect_price,
`Effet de surévaluation sur le prix` = surevaluation_effect_price,
`Effet du prix seuil sur le prix` = boycott_price_effect_price,
`Effet total du boycott sur la demande` = total_effect_demand,
`Effet de la consommation activiste sur la demande` = activist_effect_demand,
`Effet de surévaluation sur la demande` = surevaluation_effect_demand,
`Effet du prix seuil sur la demande` = boycott_price_effect_demand
)%>%
kbl()%>%
kable_paper("striped", full_width = F)%>%
column_spec (c(1,7),border_left = F, border_right = T)%>%
pack_rows("Cas 1 : Boycott souple, 5% d'activistes parmi les ménages à assez haut revenu, prix de boycott 0,25€", 1,3)%>%
pack_rows("Cas 2 : Boycott strict, 5% d'activistes parmi les ménages avec la plus faible sensiblité prix, prix de boycott 0,25€", 4,6)%>%
footnote(general = "Les prix sont en euros. Les distributeurs anticipent la demande selon la configuration (1) pour la fixation des prix, dans laquelle chaque ménage aurait pu acheter chez tous les distributeurs
", footnote_as_chunk = T)
# retailer_price_list_range%>%
#   lapply(
#     FUN = function(x){
#       round(100*(x - retailer_price_list_test)/retailer_price_list_test)
#     }
#   )
readRDS("Inputs/price_range_hard_25_35_2.rds")
# retailer_price_list_range%>%
#   lapply(
#     FUN = function(x){
#       round(100*(x - retailer_price_list_test)/retailer_price_list_test)
#     }
#   )
retailer_price_list_range = readRDS("Inputs/price_range_hard_25_35_2.rds")
boycott_price_min = 0.25
boycott_price_max = 0.35
boycott_step = 0.02
boycott_price_range = boycott_price_min + boycott_step * 0:(1+(boycott_price_max-boycott_price_min)/boycott_step)
# retailer_price_list_range%>%
#   lapply(
#     FUN = function(x){
#       round(100*(x - retailer_price_list_test)/retailer_price_list_test)
#     }
#   )
retailer_price_list_range = readRDS("Inputs/price_range_hard_25_35_2.rds")
hhid_activist_list = hhid_activist_list_alpha_5percent
boycott_type = "hard"
demand_range = 1:length(retailer_price_list_range)%>%
lapply(
FUN = function(n){
demand_and_matrix = generate_cross_product_derivative_and_demand(
model,
retailer_price_list_range[[n]],
conditionals,
rep(boycott_price_range[[n]], length(retailer_price_list_test)),
hhid_activist_list, boycott_type = boycott_type
)%>%
.$demand%>%
.[relevant_product_number_list]
}
)
activist_demand_range = 1:length(retailer_price_list_range)%>%
lapply(
FUN = function(n){
demand_and_matrix = generate_cross_product_derivative_and_demand(
model,
retailer_price_list_range[[n]],
conditionals,
rep(boycott_price_range[[n]], length(retailer_price_list_test)),
hhid_activist_list, boycott_type = boycott_type, subsample = "activist"
)%>%
.$demand%>%
.[relevant_product_number_list]
}
)
initial_price = retailer_price_list_test
initial_demand = generate_cross_product_derivative_and_demand(
model, retailer_price_list_test, conditionals,
)%>% .$demand%>% .[relevant_product_number_list]
initial_organic_price = df_price%>%
filter(periode == 12)%>%
group_by(label)%>%
summarise(avg_price = mean(avg_price))%>%
filter(label == "labelbio")%>%
.[[1,"avg_price"]]
price_without_activist = compute_equilibrium_price(
model, retailer_price_list_test, conditionals,
activist_price_list_test, hhid_activist_list_test,
boycott_type = "hard", subsample = "passive"
)
organic_price_without_activist =
data.frame(
price = price_without_activist,
label = df_product$label
)%>%
group_by(label)%>%
summarise(avg_price = mean(price))%>%
filter(label == "labelbio")%>%
.[[1,"avg_price"]]
df_boycott_analysis = lapply(
X = 1:length(boycott_price_range),
FUN = function(n){
data.frame(
boycott_price = boycott_price_range[[n]],
product_number = df_product$product_number,
retailer_price = retailer_price_list_range[[n]],
demand = demand_range[[n]],
activist_demand = activist_demand_range[[n]]
)
}
)%>%
bind_rows()%>%
left_join(df_product)%>%
mutate(passive_demand = demand - activist_demand)
df_boycott_analysis_label = df_boycott_analysis%>%
group_by(boycott_price, label)%>%
summarise(
retailer_price = mean(retailer_price),
demand = sum(demand),
activist_demand = sum(activist_demand),
passive_demand = sum(passive_demand)
)
df_boycott_analysis_label%>%
filter(
#abs(boycott_price - 0.30) < 0.001,
label == "labelbio"
)
# Display parameters
offset = 0.37
scaling = 6000
ggplot(
df_boycott_analysis_label%>%
filter(label == "labelbio")%>%
pivot_longer(
cols = c("activist_demand", "passive_demand"),
names_to = "demand_type"
),
aes(x = boycott_price)
)+
geom_col(aes(y = value, fill = demand_type), position = "stack")+
geom_line(aes(y = (retailer_price-offset)*scaling), size = 1)+
geom_hline(
yintercept = (initial_organic_price-offset)*scaling,
linetype = "longdash"
)+
geom_text(
x = quantile(boycott_price_range, probs = 0.8),
y = (initial_organic_price-offset)*scaling - 20,
check_overlap = TRUE,
label = "Initial price"
)+
geom_hline(
yintercept = (organic_price_without_activist-offset)*scaling,
linetype = "dotted"
)+
geom_text(
x = quantile(boycott_price_range, probs = 0.8),
y = (organic_price_without_activist-offset)*scaling + 20,
check_overlap = TRUE,
label = "Hypothetical price without activist"
)+
scale_y_continuous(
name = NULL,
breaks = NULL, position = "right",
sec.axis = sec_axis( trans=~./scaling+offset,
name="Average retailer price for organic eggs",
guide = guide_axis(position = "left"))
)+
scale_fill_manual(
name = NULL,
values = c("tomato1", "lightblue"),
breaks = c("activist_demand", "passive_demand"),
labels = c("Activist demand", "Passive demand"),
aesthetics = c("fill")
)+
theme_bw()+
xlab("Boycott price") +
theme(legend.position = "bottom")
