model,
apollo_probabilities,
apollo_inputs,
prediction_settings
)
predicted_market_shares = forecast%>%
pivot_longer(
cols = grep("alt", names(forecast), value = TRUE),
names_to = "alternative", values_to = "shopping_trip_market_share"
)%>%
mutate(
organic = alternative %in% paste0("alt", organic_product_list),
total_market = sum(shopping_trip_market_share)
)%>%
group_by(organic)%>%
summarise(
market_share = 100 * sum(shopping_trip_market_share) / max(total_market)
)
#### WHO CONSUMES ORGANIC PRODUCTS ?
household = readRDS("Inputs/household.rds")
hist(
household_extended%>%
filter(share_bio>0)%>%
.$share_bio
)
ggplot(
household_extended%>%
filter(wtp < 0.5)
)+
geom_point(
aes(x = wtp, y = share_bio)
)+
geom_smooth(
formula = "y ~ x",
aes(x = wtp, y = share_bio)
)
ggplot(
household_extended,
aes(x = share_bio, y = wtp)
)+
geom_point()+
geom_smooth(formula = "y ~ x", method = "loess")
## Share of organic consumption in the population
## Probit to predict share of organic consumption based on demographics
## Correlation between WTP and share of organic consumption
table_segment = posterior%>%
mutate(
yhes_dummy = young_highly_educated_single,
epmhi_dummy = educated_parents_middle_high_income,
peak2_dummy = (wtp > 2),
peak1_dummy = (wtp > 1),
share80_dummy = (share_bio > 0.8),
share10_dummy = (share_bio > 0.1),
all_dummy
)%>%
group_by(all_dummy)%>%
mutate(
all_mass = n()/3899,
all_wtp_mean = mean(wtp),
all_wtp_logmean = mean(log(wtp)),
all_wtp_sd = sd(wtp),
all_wtp_logsd = sd(log(wtp)),
all_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(peak2_dummy)%>%
mutate(
peak2_mass = n()/3899,
peak2_wtp_mean = mean(wtp),
peak2_wtp_logmean = mean(log(wtp)),
peak2_wtp_sd = sd(wtp),
peak2_wtp_logsd = sd(log(wtp)),
peak2_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(peak1_dummy)%>%
mutate(
peak1_mass = n()/3899,
peak1_wtp_mean = mean(wtp),
peak1_wtp_logmean = mean(log(wtp)),
peak1_wtp_sd = sd(wtp),
peak1_wtp_logsd = sd(log(wtp)),
peak1_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(share80_dummy)%>%
mutate(
share80_mass = n()/3899,
share80_wtp_mean = mean(wtp),
share80_wtp_logmean = mean(log(wtp)),
share80_wtp_sd = sd(wtp),
share80_wtp_logsd = sd(log(wtp)),
share80_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(share10_dummy)%>%
mutate(
share10_mass = n()/3899,
share10_wtp_mean = mean(wtp),
share10_wtp_logmean = mean(log(wtp)),
share10_wtp_sd = sd(wtp),
share10_wtp_logsd = sd(log(wtp)),
share10_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(yhes_dummy)%>%
mutate(
yhes_mass = n()/3899,
yhes_wtp_mean = mean(wtp),
yhes_wtp_logmean = mean(log(wtp)),
yhes_wtp_sd = sd(wtp),
yhes_wtp_logsd = sd(log(wtp)),
yhes_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(epmhi_dummy)%>%
mutate(
epmhi_mass = n()/3899,
epmhi_wtp_mean = mean(wtp),
epmhi_wtp_logmean = mean(log(wtp)),
epmhi_wtp_sd = sd(wtp),
epmhi_wtp_logsd = sd(log(wtp)),
epmhi_organic_share = mean(share_bio)
)%>%
ungroup()%>%
select(
contains(c("all", "share80", "share10", "peak2", "peak1", "yhes", "epmhi"))
)%>%
# Creates an appropriate table
unique()%>%
drop_na()%>%
pivot_longer(
cols = contains("dummy"),
names_to = "subset",
values_to = "dummy"
)%>%
mutate(
subset = gsub("_dummy", "", subset)
)%>%
pivot_longer(
cols = !contains(c("dummy", "subset", "dummy")),
names_to = "statistic"
)%>%
filter(str_detect(statistic, subset))%>%
unique()%>%
mutate(
statistic = gsub("^[^_]*_", "", statistic)
)%>%
arrange(subset, dummy, statistic)%>%
select(subset, dummy, statistic, value)%>%
pivot_wider(names_from = statistic, values_from = value)
table_segment = posterior%>%
mutate(
yhes_dummy = young_highly_educated_single,
epmhi_dummy = educated_parents_middle_high_income,
peak2_dummy = (wtp > 2),
peak1_dummy = (wtp > 1),
share80_dummy = (share_bio > 0.8),
share10_dummy = (share_bio > 0.1),
all_dummy = TRUE
)%>%
group_by(all_dummy)%>%
mutate(
all_mass = n()/3899,
all_wtp_mean = mean(wtp),
all_wtp_logmean = mean(log(wtp)),
all_wtp_sd = sd(wtp),
all_wtp_logsd = sd(log(wtp)),
all_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(peak2_dummy)%>%
mutate(
peak2_mass = n()/3899,
peak2_wtp_mean = mean(wtp),
peak2_wtp_logmean = mean(log(wtp)),
peak2_wtp_sd = sd(wtp),
peak2_wtp_logsd = sd(log(wtp)),
peak2_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(peak1_dummy)%>%
mutate(
peak1_mass = n()/3899,
peak1_wtp_mean = mean(wtp),
peak1_wtp_logmean = mean(log(wtp)),
peak1_wtp_sd = sd(wtp),
peak1_wtp_logsd = sd(log(wtp)),
peak1_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(share80_dummy)%>%
mutate(
share80_mass = n()/3899,
share80_wtp_mean = mean(wtp),
share80_wtp_logmean = mean(log(wtp)),
share80_wtp_sd = sd(wtp),
share80_wtp_logsd = sd(log(wtp)),
share80_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(share10_dummy)%>%
mutate(
share10_mass = n()/3899,
share10_wtp_mean = mean(wtp),
share10_wtp_logmean = mean(log(wtp)),
share10_wtp_sd = sd(wtp),
share10_wtp_logsd = sd(log(wtp)),
share10_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(yhes_dummy)%>%
mutate(
yhes_mass = n()/3899,
yhes_wtp_mean = mean(wtp),
yhes_wtp_logmean = mean(log(wtp)),
yhes_wtp_sd = sd(wtp),
yhes_wtp_logsd = sd(log(wtp)),
yhes_organic_share = mean(share_bio)
)%>%
ungroup()%>%
group_by(epmhi_dummy)%>%
mutate(
epmhi_mass = n()/3899,
epmhi_wtp_mean = mean(wtp),
epmhi_wtp_logmean = mean(log(wtp)),
epmhi_wtp_sd = sd(wtp),
epmhi_wtp_logsd = sd(log(wtp)),
epmhi_organic_share = mean(share_bio)
)%>%
ungroup()%>%
select(
contains(c("all", "share80", "share10", "peak2", "peak1", "yhes", "epmhi"))
)%>%
# Creates an appropriate table
unique()%>%
drop_na()%>%
pivot_longer(
cols = contains("dummy"),
names_to = "subset",
values_to = "dummy"
)%>%
mutate(
subset = gsub("_dummy", "", subset)
)%>%
pivot_longer(
cols = !contains(c("dummy", "subset", "dummy")),
names_to = "statistic"
)%>%
filter(str_detect(statistic, subset))%>%
unique()%>%
mutate(
statistic = gsub("^[^_]*_", "", statistic)
)%>%
arrange(subset, dummy, statistic)%>%
select(subset, dummy, statistic, value)%>%
pivot_wider(names_from = statistic, values_from = value)
stargazer(table_segment, summary = FALSE)
ggplot(
posterior,
aes(x = share_bio)
)+
geom_histogram()+
scale_x_continuous(limits = c(0.6, 3))
ggplot(
posterior,
aes(x = share_bio)
)+
geom_histogram()+
scale_x_continuous(limits = c(0,1))
ggplot(
posterior,
aes(x = share_bio)
)+
geom_histogram()+
scale_x_continuous(limits = c(0,1))+
scale_y_continuous(limits = c(0,500))
ggplot(
posterior,
aes(x = share_bio)
)+
geom_histogram()+
scale_x_continuous(limits = c(0,1))+
scale_y_continuous(limits = c(0,250))
ggplot(
posterior,
aes(x = share_bio)
)+
geom_histogram(binwidth = 0.05)+
scale_x_continuous(limits = c(0,1))+
scale_y_continuous(limits = c(0,250))
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(limits = c(0,1))+
scale_y_continuous(limits = c(0,250))
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of organic eggs in the household", limits = c(0,1))+
scale_y_continuous(limits = c(0,250))
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic", limits = c(0,1))+
scale_y_continuous(limits = c(0,250))
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic", limits = c(0,1))+
scale_y_continuous(name = "Number of households", limits = c(0,250))
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic")+
scale_y_continuous(name = "Number of households", limits = c(0,250))
View(posterior)
posterior%>%
filter(share_bio < 0.001)
posterior%>%
filter(share_bio < 0.001)%>%
nrow()
View(posterior)
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic")+
scale_y_continuous(name = "Number of households")
limits = c(0,250)
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic")+
scale_y_continuous(name = "Number of households", limits = c(0,250))
posterior%>%
filter(share_bio < 0.001)%>%
nrow()
2732/3899
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic")+
scale_y_continuous(name = "Number of households", limits = c(0,250))+
caption("There are 2732 households (70%) in the sample that never purchase eggs")
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic")+
scale_y_continuous(name = "Number of households", limits = c(0,250))+
theme(caption = "There are 2732 households (70%) in the sample that never purchase eggs")
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic")+
scale_y_continuous(name = "Number of households", limits = c(0,250))+
labs(caption = "There are 2732 households (70%) in the sample that never purchase eggs")
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of egg purchases by the household that are organic")+
scale_y_continuous(name = "Number of households", limits = c(0,250))+
labs(caption = "2732 households (70%) that never purchase eggs are not represented here")
posterior%>%
filter(share_bio < 0.05)%>%
nrow()
2864/3899
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of organic egg purchases by the household")+
scale_y_continuous(name = "Number of households", limits = c(0,250))+
labs(caption = "2732 households (70%) that never purchase eggs are not represented here")
ggsave(device = "png", file = "share_bio_household.png")
ggsave(
device = "png",
file = "share_bio_household.png",
units = "cm",
width = 15,
height = 15
)
ggsave(
device = "png",
file = "Outputs/share_bio_household.png",
units = "cm",
width = 15,
height = 15
)
ggplot(
posterior,
)+
geom_histogram(aes(x = share_bio), binwidth = 0.05)+
scale_x_continuous(name = "Share of organic egg purchases by the household")+
scale_y_continuous(name = "Number of households", limits = c(0,250))+
labs(caption = "2732 households (70%) that never purchase organic eggs are not represented here")
ggsave(
device = "png",
file = "Outputs/share_bio_household.png",
units = "cm",
width = 15,
height = 15
)
stargazer(
fit_posterior_demographics,
type = "text"
#type = "html"
)
View(posterior)
View(posterior)
View(posterior)
fit_posterior_demographics = lm(
-price_sensibility ~ rve + habi_inra + etud,
data = posterior
)
fit_posterior_demographics = lm(
-price_sensibility ~ rve + habi_inra + max_etud,
data = posterior
)
stargazer(
fit_posterior_demographics,
type = "text"
#type = "html"
)
fit_posterior_demographics = lm(
-price_sensibility ~ rve + habi_inra + as.factor(max_etud),
data = posterior
)
fit_posterior_demographics = lm(
-price_sensibility ~ rve + habi_inra + as.factor(max_etud),
data = posterior%>%
mutate(
max_etud = case_when(
max_etud %in% c(0,1) ~ "PRIMARY EDUCATION AND BELOW",
max_etud == 2 ~ "SECONDARY EDUCATION (FIRST CYCLE)",
max_etud %in% c(3,4) ~ "SECONDARY EDUCATION (SECOND CYCLE)",
max_etud == 5 ~ "SHORT HIGHER EDUCATION TRAINING",
max_etud == 6 ~ "BACHELOR DEGREE OR EQUIVALENT",
max_etud >= 7 ~ "MASTER DEGREE AND BEYOND",
)
)
)
stargazer(
fit_posterior_demographics,
type = "text"
#type = "html"
)
fit_posterior_demographics = lm(
-price_sensibility ~ rve + habi_inra,
data = posterior
)
stargazer(
fit_posterior_demographics,
type = "text"
#type = "html"
)
stargazer(
fit_posterior_demographics,
type = "latex"
)
ggplot(
posterior,
)+
geom_histogram(aes(x = wtp), binwidth = 0.1)+
scale_x_continuous(name = "Willingness to pay for organic eggs")+
scale_y_continuous(name = "Number of households")+
labs(caption = "2732 households (70%) that never purchase organic eggs are not represented here")
ggplot(
posterior,
)+
geom_histogram(aes(x = wtp), binwidth = 0.1)+
scale_x_continuous(name = "Willingness to pay for organic eggs", limits = c(0,3))+
scale_y_log10(name = "Number of households")+
labs(caption = "2732 households (70%) that never purchase organic eggs are not represented here")
ggplot(
posterior,
)+
geom_histogram(aes(x = wtp), binwidth = 0.1)+
scale_x_continuous(name = "Willingness to pay for organic eggs", limits = c(0,4))+
scale_y_log10(name = "Number of households")+
labs(caption = "2732 households (70%) that never purchase organic eggs are not represented here")
ggplot(
posterior,
)+
geom_histogram(aes(x = wtp), binwidth = 0.1)+
scale_x_continuous(name = "Willingness to pay for organic eggs", limits = c(0,4))+
scale_y_log10(name = "Number of households")+
labs(caption = "THe vertical scale is logarithmic")
ggplot(
posterior,
)+
geom_histogram(aes(x = wtp), binwidth = 0.1)+
scale_x_continuous(name = "Willingness to pay for organic eggs", limits = c(0,4))+
scale_y_log10(name = "Number of households")+
labs(caption = "The vertical scale is logarithmic")
ggsave(
device = "png",
file = "Outputs/wtp_household.png",
units = "cm",
width = 20,
height = 15
)
